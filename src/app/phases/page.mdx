import { defaultKeywords, defaultOpenGraph } from '../metadata'

export const metadata = {
  title: 'Phases',
  description:
    'This guide shows how to create and add various test phases in TofuPilot and view the automatically generated reports, helping to identify frequent failures and time-consuming phases.',
  keywords: [
    ...defaultKeywords,
    'Test Phases',
    'Test Steps',
    'TofuPilot Phases',
    'Automated Testing',
    'Test Analytics',
    'Hardware Testing',
  ],
  openGraph: {
    ...defaultOpenGraph,
    title:
      'Phases - Test Phase Management & Analytics | TofuPilot Documentation',
    description:
      'Learn how to define, execute, and analyze test phases in TofuPilot, improving test efficiency and failure analysis.',
    images: [
      {
        url: 'https://tofupilot.com/docs/phases-header.png',
        width: 800,
        height: 600,
        alt: 'Phases section header showing test phase management within TofuPilot.',
      },
    ],
  },
}

# Phases and Measurements

Structure your hardware tests with phases, and enrich each phase with one or more measurements.{{ className: 'lead' }}

<Image
  src="/phases-header.png"
  alt="Phases section header showing test phase management whithin TofuPilot."
/>

## Overview

A test procedure in TofuPilot is made of sequential phases—these represent logical blocks of a test such as “Check Voltage”. Each phase performs a specific function and records its own start and end time, as well as its outcome.

Inside a phase, you can record one or more measurements. A measurement is a captured value, like a voltage, temperature, or pass/fail condition. Measurements can include numeric limits, units, and outcomes.

Phases give you structure; measurements capture the data. Together, they allow TofuPilot to display test results clearly, analyze failure patterns, and provide meaningful metrics like yield, duration, and control limits over time.


## Phases integration

TofuPilot tracks each phase with its name, outcome, and duration. With OpenHTF, you simply define the phases in the `Test`, and TofuPilot collects the information automatically.

<CodeGroup>
  <CodeGithub
    title="OpenHTF"
    branch="main"
    path="docs_tofupilot/phases/required/openhtf/main.py"
  />
  <CodeGithub
    title="Vanilla Python"
    branch="main"
    path="docs_tofupilot/phases/required/client/main.py"
  />
</CodeGroup>

### Phases properties

<Properties>
    <Property name="phases" type="array ">
        List of phases.
    </Property>
    <Property name="name" type="str"  indent={1}>
        The name of the phase.
    </Property>
    <Property name="outcome" type='"PASS" | "FAIL" | "ERROR" | "SKIP"'  indent={1}>
        Result of the phase. _Example: "PASS"_
    </Property>
    <Property name="start_time_millis" type="number (optional)"  indent={1}>
        Start time (Unix ms). _Example: 1726147200000_
    </Property>
    <Property name="end_time_millis" type="number (optional)"  indent={1}>
        End time (Unix ms). _Example: 1726147230000_
    </Property>
    <Property name="measurements" type="array (optional)"  indent={1}>
        List of measurements in the phase.
    </Property>
</Properties>

## Measurements integration

Each phase can include one or more measurements. These can be numeric, boolean, string, or multi-dimensional arrays. With OpenHTF, you simply define the measurements using `openhtf.measures` and `openhtf.Measurement`, and TofuPilot collects the information automatically.

<CodeGroup>
  <CodeGithub
    title="OpenHTF"
    branch="main"
    path="docs_tofupilot/phases/optional/openhtf/main.py"
  />
  <CodeGithub
    title="Python"
    branch="main"
    path="docs_tofupilot/phases/optional/client/main.py"
  />
</CodeGroup>

### Measurements properties

<Properties>
    <Property name="measurements" type="array (optional)">
        List of measurements in the phase.
    </Property>
    <Property name="name" type="string" indent={1}>
        Name of one measurement.
    </Property>
    <Property
        name="outcome"
        type='"PASS" | "FAIL" | "UNSET"'
        indent={1}
    >
        Outcome of the measurement.
    </Property>
    <Property
        name="measured_value"
        type="number | string | boolean | dict (optional)"
        indent={1}
    >
        Captured value.
    </Property>
    <Property name="units" type="string | array (optional)" indent={1}>
        Units of the value. _Examples: Volts, Celsius_
    </Property>
    <Property name="lower_limit" type="number (optional)" indent={1}>
        Minimum valid value (only for numbers).
    </Property>
    <Property name="upper_limit" type="number (optional)" indent={1}>
        Maximum valid value (only for numbers).
    </Property>
</Properties>

## In-app view

### Run page

Each test run shows a breakdown of all phases and their associated measurements.

<Image
  src="/phases-page-run.png"
  alt="Phases section header showing test phase management whithin TofuPilot."
/>

### Procedure Page

Clicking a phase in the **Run** page opens the **Procedure** page. You can analyze all historical data for that phase: average duration, yield, number of runs, and Cpk.

<Image
  src="/phases-page-procedure1.png"
  alt="Phases section header showing test phase management whithin TofuPilot."
/>

You can view phase details in the tabs or the **Control Chart** by clicking on a phase (e.g., `phase_one`). The Control Chart displays limits `lower_limit` and `upper_limit` and the 6-sigma standard deviation, calculated automatically.

<Note>
    If measurement limits have changed over time, TofuPilot uses the most recent ones for charting.
</Note>

<Image
  src="/phases-page-procedure2.png"
  alt="Phases section header showing test phase management whithin TofuPilot."
/>

To unselect a phase, click its name on the top bar of the page or click on **Clear Filter**.

---

## Advanced integration

### Multiple measurements in one phase

You can group several related metrics within a single test block.

<CodeGroup>
  <CodeGithub
    title="OpenHTF"
    branch="charlotte/new-features-ope-ui"
    path="docs_tofupilot/phases/multi-measurements/openhtf/main.py"
  />
  <CodeGithub
    title="Python"
    branch="charlotte/new-features-ope-ui"
    path="docs_tofupilot/phases/multi-measurements/client/main.py"
  />
</CodeGroup>


<Image
  src="/phases-multi-measurements.png"
  alt="Multi-measurements displayed in one phase"
/>

### Multi-dimensional measurements

You can capture arrays or time-series data within a single measurement.

<CodeGroup>
  <CodeGithub
    title="OpenHTF"
    branch="charlotte/new-features-ope-ui"
    path="docs_tofupilot/phases/dimensions/openhtf/main.py"
  />
  <CodeGithub
    title="Python"
    branch="charlotte/new-features-ope-ui"
    path="docs_tofupilot/phases/dimensions/client/main.py"
  />
</CodeGroup>

You can open and explore dimension-based measurements by clicking the chart button within the Phases chart on the **Run** page:

<Image
  src="/phases-dimensions-measurements.png"
  alt="Example of dimension-based measurements displayed in a chart."
/>
