export const metadata = {
  title: 'Runs API Reference | TofuPilot',
  description:
    'On this page, we’ll dive into the different run endpoints you can use to manage runs programmatically.',
}

# Runs

Runs are an essential part of TofuPilot — they are the the primary method for systematically testing and evaluating hardware performance and reliability. On this page, we’ll dive into the different run endpoints you can use to manage runs programmatically. {{ className: 'lead' }}

---

## Create a run {{ tag: 'POST', label: '/v1/runs' }}

<Row>
  <Col>

    This endpoint allows you to register a new run based on a procedure and performed on a unit.

    ## Required attributes

    <Properties>
      <Property name="procedure_id" type="string">
        Unique identifier for the run's procedure.
      </Property>
      <Property name="unit_under_test" type="record">
      - serial_number (string): Serial number of the unit
      - part_number (string): Part number of the unit's component
      - revision (optional, string): Revision of the unit's component. Required if component has more than one revision.
      </Property>
      <Property name="run_passed" type="boolean">
        Boolean indicating whether the run passed or not.
      </Property>
    </Properties>

    ## Optional attributes

    <Properties>
    <Property name="duration" type="string / timedelta">
        ISO8601 string or datetime.timedelta (for Python client) indicating the duration of the run.
      </Property>
      <Property name="attachments" type="array(string)">
        A list of absolute file paths that should be added as run's attachments.
      </Property>
      <Property name="sub_units" type="array(record)">
        A list of unit identifiers that should be added as sub-units of the run's unit
        - serial_number (string): Serial number of the sub-unit
      </Property>
      <Property name="params" type="record(string, string)">
        {"A dictionary of key/value pairs used to replace {{smart fields}} in the procedure's document."}
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/v1/runs">

```python
from tofupilot import TofuPilotClient
from datetime import timedelta, datetime

def test_function():
    # Your actual test logic
    ###

    run_passed = True
    params = {
        "param1": "value1",
        "param2": "value2"
    }
    attachments = [
        "/path/to/attachment1",
        "/path/to/attachment2"
    ]

    return run_passed, params, attachments

# Measure the duration of the test_function
start_time = datetime.now()
run_passed, params, attachments = test_function()
end_time = datetime.now()
duration = end_time - start_time

client = TofuPilotClient(api_key="your_api_key")

client.create_run(
    procedure_id="FVT1",
    unit_under_test={
        "serial_number": 'EXAMPLE-SERIAL-NUMBER',
        "part_number": 'EXAMPLE-PART-NUMBER',
    },
    run_passed=run_passed,
    duration=duration,
    params=params,
    attachments=attachments
)
```

```bash {{ title: 'cURL' }}
curl -X POST https://www.tofupilot.com/api/v1/runs
  -H "Content-Type: application/json"
  -H "Authorization: Bearer {your_api_key}"
  -d '{
    "procedure_id": "FVT1",
    "unit_under_test": {
      "serial_number": "EXAMPLE-SERIAL-NUMBER",
      "part_number": "EXAMPLE-PART-NUMBER"
    },
    "run_passed": true,
    "duration": "PT27M15S"
}'
```

```js
fetch('https://www.tofupilot.com/api/v1/runs', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    Authorization: 'Bearer "your_api_key"',
  },
  body: JSON.stringify({
    procedure_id: 'FVT1',
    unit_under_test: {
      serial_number: 'EXAMPLE-SERIAL-NUMBER',
      part_number: 'EXAMPLE-PART-NUMBER',
    },
    run_passed: true,
    duration: 'PT27M15S',
  }),
})
```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "url": "https://tofupilot.com/acme-corp/runs/your-new-run"
    }
    ```

  </Col>
</Row>
